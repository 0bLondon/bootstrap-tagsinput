/*
 * bootstrap-tagsinput v0.0.1 by Tim Schlechter
 * https://raw.github.com/TimSchlechter/bootstrap-tagsinput/master/LICENSE
 */
!function(a){"use strict";function b(b,c){this.$element=a(b),this.multiple="SELECT"===b.tagName&&b.getAttribute("multiple"),this.$container=a('<div class="bootstrap-tagsinput"><input size="1" type="text" /></div>'),this.$element.hide(),this.$element.after(this.$container),this.build(c)}function c(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(a){return a[c]}}}function d(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(){return c}}}function e(a){return a?i.text(a).html():""}function f(a){var b=0;if(document.selection){a.focus();var c=document.selection.createRange();c.moveStart("character",-a.value.length),b=c.text.length}else(a.selectionStart||"0"==a.selectionStart)&&(b=a.selectionStart);return b}var g={tagClass:"badge badge-info",itemValue:function(a){return a?a.toString():a},itemText:function(a){return this.itemValue(a)}};b.prototype={constructor:b,addItem:function(b){var c=this;if(b===!1||b){if("object"==typeof b&&c.options.itemValue===g.itemValue)throw"Can't add objects when itemValue option is not set";if(!b.toString().match(/^\s*$/)&&-1===a.inArray(b,c.getItems())){var d=a('<span class="tag '+e(c.options.tagClass)+'"><span class="text"></span><i class="icon-white icon-remove" data-role="remove"></i></span>');a(".text",d).text(c.options.itemText(b)),d.data("item",b),a("input",c.$container).before(d),"SELECT"===c.$element[0].tagName&&c.$element.append(a('<option value="'+e(c.options.itemValue(b))+'" selected>'+e(b)+"</option>")),c.$element.val(c.getValueFromTags(),!0)}}},removeItem:function(b){var c=this;a(".tag",c.$container).filter(function(){return a(this).data("item")===b}).remove(),c.$element.val(c.getValueFromTags(),!0)},getValueFromTags:function(){var b=this;return a.map(b.getItems(),function(a){return b.options.itemValue(a)})},getItems:function(){var b=this;return a.map(a(".tag",b.$container),function(b){return a(b).data("item")})},build:function(b){var e=this;e.options=a.extend({},g,b),c(e.options,"itemValue"),c(e.options,"itemText"),d(e.options,"source"),e.options.source&&a("input",e.$container).typeahead({source:function(b,c){this.map={};var d=e.options.source(),f=[],g=this.map;a.each(d,function(a,b){var c=e.options.itemText(b);g[c]=b,f.push(c)}),c(f)},updater:function(a){e.addItem(this.map[a])},matcher:function(a){return-1!==a.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(a){return a.sort()},highlighter:function(a){var b=new RegExp("("+this.query+")","gi");return a.replace(b,"<strong>$1</strong>")}}),e.$container.on("click",a.proxy(function(){a("input",e.$container).focus()},e)),e.$container.on("keydown","input",a.proxy(function(b){var c=a(b.target);switch(b.which){case 8:if(0===f(c[0])){var d=e.getItems();d[0]&&e.removeItem(d[d.length-1])}break;case 37:var g=c.prev();0===c.val().length&&g[0]&&(g.before(c),c.focus());break;case 39:var h=c.next();0===c.val().length&&h[0]&&(h.after(c),c.focus());break;case 13:e.addItem(c.val()),c.val("")}c.attr("size",Math.max(1,c.val().length))},e)),e.$container.on("click","[data-role=remove]",a.proxy(function(b){var c=a(b.target).closest(".tag");e.removeItem(c.data("item"))},e))},destroy:function(){var a=this;a.$container.off("keypress","input"),a.$container.off("click","[data-role=remove]"),a.$container.remove(),a.$element.show()}},a.fn.tagsinput=function(c,d){var e=[];return this.each(function(){var f=a(this).data("tagsinput");if(!f)return f=new b(this,c),a(this).data("tagsinput",f),e.push(f),a(this).val(a(this).val()),void 0;var g;switch(c){case"add":g=f.addItem(d);break;case"remove":g=f.removeItem(d);break;case"destroy":g=f.destroy();break;case"items":g=f.getItems()}void 0!==g&&e.push(g)}),"string"==typeof c?e.length>1?e:e[0]:e},a.fn.tagsinput.Constructor=b;var h=a.fn.val;a.fn.val=function(b,c){return arguments.length?(c||this.each(function(){var c=a(this).data("tagsinput"),d=b;c&&("string"!=typeof d||this.multiple||(d=d.split(",")),a.each(a.makeArray(d),function(a,b){c.addItem(b)}))}),h.call(this,b)):h.call(this)};var i=a("<div />");a(function(){a("input[data-role=tagsinput], select[data-role=tagsinput]").tagsinput()})}(window.jQuery);